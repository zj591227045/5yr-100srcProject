<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="/wxauto-mgt/">
    <title>WXAUTO-MGT 用户操作手册</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #64748b;
            --success-color: #059669;
            --warning-color: #d97706;
            --danger-color: #dc2626;
            --light-bg: #f8fafc;
            --dark-bg: #1e293b;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #334155;
        }

        .navbar {
            background: linear-gradient(135deg, var(--primary-color), #3b82f6);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
        }

        .hero-section {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
            padding: 3rem 0;
            margin-bottom: 2rem;
        }

        .sidebar {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 1.5rem;
            position: sticky;
            top: 20px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        .sidebar ul {
            list-style: none;
            padding: 0;
        }

        .sidebar ul ul {
            padding-left: 1rem;
            margin-top: 0.5rem;
        }

        .sidebar a {
            color: var(--secondary-color);
            text-decoration: none;
            padding: 0.5rem 0;
            display: block;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .sidebar a:hover {
            color: var(--primary-color);
            background: #f1f5f9;
            padding-left: 0.5rem;
        }

        .sidebar a.active {
            color: var(--primary-color);
            background: #dbeafe;
            font-weight: 600;
            padding-left: 0.5rem;
        }

        .content-section {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .section-header {
            border-bottom: 2px solid #e2e8f0;
            padding-bottom: 1rem;
            margin-bottom: 2rem;
        }

        .section-title {
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .step-list {
            counter-reset: step-counter;
        }

        .step-item {
            counter-increment: step-counter;
            position: relative;
            padding-left: 3rem;
            margin-bottom: 2rem;
        }

        .step-item::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.875rem;
        }

        .config-box {
            background: var(--light-bg);
            border-left: 4px solid var(--primary-color);
            padding: 1rem;
            border-radius: 0 8px 8px 0;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
        }

        .platform-card {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .platform-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .platform-icon {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            color: white;
            margin-bottom: 1rem;
        }

        .icon-primary { background: var(--primary-color); }
        .icon-success { background: var(--success-color); }
        .icon-warning { background: var(--warning-color); }
        .icon-danger { background: var(--danger-color); }

        .alert-custom {
            border: none;
            border-radius: 8px;
            padding: 1rem 1.5rem;
        }

        .alert-info-custom {
            background: #dbeafe;
            color: #1e40af;
        }

        .alert-warning-custom {
            background: #fef3c7;
            color: #92400e;
        }

        .alert-success-custom {
            background: #d1fae5;
            color: #065f46;
        }

        .faq-item {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .faq-question {
            background: #f8fafc;
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .faq-question:hover {
            background: #f1f5f9;
        }

        .faq-answer {
            padding: 1.5rem;
            display: none;
        }

        .faq-answer.show {
            display: block;
        }

        .version-badge {
            background: var(--success-color);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .sidebar {
                position: static;
                margin-bottom: 2rem;
            }
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="index.html"><i class="fas fa-robot me-2"></i>WXAUTO-MGT</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">首页</a></li>
                    <li class="nav-item"><a class="nav-link" href="quick-start-guide.html">快速入门</a></li>
                    <li class="nav-item"><a class="nav-link active" href="#">完整手册</a></li>
                    <li class="nav-item"><a class="nav-link" href="download.html">软件下载</a></li>
                    <li class="nav-item"><a class="nav-link" href="https://github.com/zj591227045/WXAUTO-MGT/issues" target="_blank">技术支持</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- 英雄区域 -->
    <section class="hero-section">
        <div class="container text-center">
            <h1 class="display-4 fw-bold text-primary mb-3">
                <i class="fas fa-book me-3"></i>用户操作手册
            </h1>
            <p class="lead text-muted mb-3">详细的功能说明和操作指导，涵盖所有功能模块</p>
            <span class="version-badge">v2.0.0</span>
            <p class="mt-3 text-muted">更新时间：2025年1月</p>
        </div>
    </section>

    <div class="container">
        <div class="row">
            <!-- 侧边栏目录 -->
            <div class="col-lg-3">
                <div class="sidebar">
                    <h6><i class="fas fa-list me-2"></i>目录</h6>
                    <ul>
                        <li><a href="#overview" data-section="overview">概述</a></li>
                        <li><a href="#instance-init" data-section="instance-init">实例初始化</a></li>
                        <li><a href="#platforms" data-section="platforms">添加服务平台</a>
                            <ul>
                                <li><a href="#platform-dify" data-section="platform-dify">Dify平台</a></li>
                                <li><a href="#platform-openai" data-section="platform-openai">OpenAI平台</a></li>
                                <li><a href="#platform-coze" data-section="platform-coze">Coze平台</a></li>
                                <li><a href="#platform-keyword" data-section="platform-keyword">关键词匹配</a></li>
                                <li><a href="#platform-zhiweijz" data-section="platform-zhiweijz">只为记账</a></li>
                            </ul>
                        </li>
                        <li><a href="#rules" data-section="rules">消息转发规则</a></li>
                        <li><a href="#web-console" data-section="web-console">Web控制台</a></li>
                        <li><a href="#mobile-access" data-section="mobile-access">移动端访问</a></li>
                        <li><a href="#listeners" data-section="listeners">监听对象管理</a></li>
                        <li><a href="#advanced" data-section="advanced">高级功能</a></li>
                        <li><a href="#troubleshooting" data-section="troubleshooting">故障排除</a></li>
                        <li><a href="#faq" data-section="faq">常见问题</a></li>
                    </ul>
                </div>
            </div>

            <!-- 主要内容 -->
            <div class="col-lg-9">
                <!-- 概述 -->
                <section id="overview" class="content-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-info-circle me-2"></i>概述</h2>
                        <p class="text-muted">WXAUTO-MGT是一款智能微信消息管理工具，支持多AI平台集成和自动回复功能。</p>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <h5>主要功能</h5>
                            <ul>
                                <li>多微信实例管理</li>
                                <li>AI平台集成（OpenAI、Dify、Coze等）</li>
                                <li>智能消息路由</li>
                                <li>Web远程管理</li>
                                <li>移动端支持</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h5>系统要求</h5>
                            <ul>
                                <li>Windows 10/11 操作系统</li>
                                <li>微信PC版已安装</li>
                                <li>网络连接正常</li>
                                <li>至少一个AI平台账号</li>
                            </ul>
                        </div>
                    </div>

                    <div class="alert alert-info-custom">
                        <i class="fas fa-lightbulb me-2"></i>
                        <strong>快速开始：</strong>如果您是新用户，建议先阅读<a href="quick-start-guide.html" class="text-decoration-none">快速入门指南</a>，5分钟即可完成基础配置。
                    </div>
                </section>

                <!-- 实例初始化 -->
                <section id="instance-init" class="content-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-cogs me-2"></i>实例初始化</h2>
                        <p class="text-muted">配置微信实例，建立与微信API的连接。</p>
                    </div>

                    <div class="step-list">
                        <div class="step-item">
                            <h5>启动软件</h5>
                            <p>双击运行 <code>WXAUTO管理工具.exe</code>，等待主界面加载完成。软件会自动创建必要的配置文件和数据库。</p>
                        </div>

                        <div class="step-item">
                            <h5>添加微信实例</h5>
                            <p>在"实例管理"选项卡中，点击"添加实例"按钮，填写以下信息：</p>
                            <div class="config-box">
                                实例名称：主微信（便于识别的名称）<br>
                                API地址：http://localhost:5000<br>
                                轮询间隔：5秒（建议5-10秒）<br>
                                消息超时：30分钟<br>
                                启用实例：✓ 勾选
                            </div>
                        </div>

                        <div class="step-item">
                            <h5>启动微信API服务</h5>
                            <p>点击工具栏"启动本地API客户端"按钮，启动 <code>wxauto_http_api.exe</code> 程序。确保微信PC版已登录。</p>
                        </div>

                        <div class="step-item">
                            <h5>验证连接</h5>
                            <p>实例卡片显示绿色表示连接成功，红色表示连接失败。如果连接失败，请检查API服务是否正常运行。</p>
                        </div>
                    </div>
                </section>

                <!-- 添加服务平台 -->
                <section id="platforms" class="content-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-brain me-2"></i>添加服务平台</h2>
                        <p class="text-muted">配置AI服务平台，实现智能自动回复功能。</p>
                    </div>

                    <div class="alert alert-info-custom mb-4">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>提示：</strong>选择实例后，在中间区域点击"添加平台"按钮开始配置。每个实例可以配置多个服务平台。
                    </div>

                    <!-- Dify平台 -->
                    <div id="platform-dify" class="platform-card">
                        <div class="d-flex align-items-start">
                            <div class="platform-icon icon-success me-3">
                                <i class="fas fa-magic"></i>
                            </div>
                            <div class="flex-grow-1">
                                <h5>Dify服务平台</h5>
                                <p class="text-muted">企业级AI应用平台，支持工作流和知识库。</p>

                                <h6>配置参数：</h6>
                                <div class="config-box">
                                    平台名称：Dify智能助手<br>
                                    平台类型：Dify<br>
                                    API Base URL：https://api.dify.ai/v1<br>
                                    API密钥：app-xxxxxxxxxxxxxxxx<br>
                                    对话ID：（可选，留空自动创建）<br>
                                    用户ID：default_user
                                </div>

                                <div class="alert alert-warning-custom">
                                    <i class="fas fa-exclamation-triangle me-2"></i>
                                    <strong>注意：</strong>API密钥格式通常以 <code>app-</code> 开头，请确保从Dify控制台获取正确的密钥。
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- OpenAI平台 -->
                    <div id="platform-openai" class="platform-card">
                        <div class="d-flex align-items-start">
                            <div class="platform-icon icon-primary me-3">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="flex-grow-1">
                                <h5>OpenAI兼容平台</h5>
                                <p class="text-muted">支持ChatGPT、GPT-4等模型，以及其他OpenAI兼容的API。</p>

                                <h6>配置参数：</h6>
                                <div class="config-box">
                                    平台名称：ChatGPT助手<br>
                                    平台类型：OpenAI<br>
                                    API Base URL：https://api.openai.com/v1<br>
                                    API密钥：sk-xxxxxxxxxxxxxxxx<br>
                                    模型名称：gpt-3.5-turbo<br>
                                    Temperature：0.7（0.0-2.0）<br>
                                    最大Token数：1000<br>
                                    系统提示词：你是一个有用的助手。
                                </div>

                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <h6>参数说明：</h6>
                                        <ul class="small">
                                            <li><strong>Temperature</strong>：控制回复随机性</li>
                                            <li><strong>Max Tokens</strong>：限制回复长度</li>
                                            <li><strong>系统提示词</strong>：定义AI角色</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <h6>推荐模型：</h6>
                                        <ul class="small">
                                            <li><code>gpt-3.5-turbo</code>：性价比高</li>
                                            <li><code>gpt-4</code>：质量更好</li>
                                            <li><code>gpt-4-turbo</code>：速度更快</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Coze平台 -->
                    <div id="platform-coze" class="platform-card">
                        <div class="d-flex align-items-start">
                            <div class="platform-icon icon-warning me-3">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="flex-grow-1">
                                <h5>扣子(Coze)服务平台</h5>
                                <p class="text-muted">字节跳动AI平台，支持工作空间和智能体管理。</p>

                                <h6>配置步骤：</h6>
                                <div class="step-list">
                                    <div class="step-item">
                                        <h6>输入API密钥</h6>
                                        <p>API密钥格式：<code>pat_xxxxxxxxxxxxxxxx</code></p>
                                    </div>
                                    <div class="step-item">
                                        <h6>选择工作空间</h6>
                                        <p>点击"刷新工作空间"按钮，从下拉列表中选择工作空间。</p>
                                    </div>
                                    <div class="step-item">
                                        <h6>选择智能体</h6>
                                        <p>点击"刷新智能体"按钮，选择要使用的智能体。</p>
                                    </div>
                                    <div class="step-item">
                                        <h6>可选设置</h6>
                                        <p>勾选"启用连续对话"以保持对话上下文。</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 关键词匹配平台 -->
                    <div id="platform-keyword" class="platform-card">
                        <div class="d-flex align-items-start">
                            <div class="platform-icon icon-danger me-3">
                                <i class="fas fa-key"></i>
                            </div>
                            <div class="flex-grow-1">
                                <h5>关键词匹配服务平台</h5>
                                <p class="text-muted">本地智能回复，无需API，支持多种匹配模式。</p>

                                <h6>配置规则：</h6>
                                <div class="step-list">
                                    <div class="step-item">
                                        <h6>设置回复时间</h6>
                                        <p>配置最小和最大回复延时，模拟真人回复。</p>
                                    </div>
                                    <div class="step-item">
                                        <h6>添加关键词规则</h6>
                                        <div class="config-box">
                                            关键词：你好,hi,hello（逗号分隔）<br>
                                            匹配类型：包含匹配<br>
                                            回复内容：您好！有什么可以帮助您的吗？<br>
                                            随机回复：✓ 勾选<br>
                                            回复时间：1-3秒
                                        </div>
                                    </div>
                                </div>

                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <h6>匹配类型：</h6>
                                        <ul class="small">
                                            <li><strong>完全匹配</strong>：消息完全等于关键词</li>
                                            <li><strong>包含匹配</strong>：消息包含关键词</li>
                                            <li><strong>模糊匹配</strong>：支持相似度匹配</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <h6>使用技巧：</h6>
                                        <ul class="small">
                                            <li>多个关键词用逗号分隔</li>
                                            <li>多条回复用换行分隔</li>
                                            <li>启用随机回复增加真实感</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 只为记账平台 -->
                    <div id="platform-zhiweijz" class="platform-card">
                        <div class="d-flex align-items-start">
                            <div class="platform-icon" style="background: #6366f1;">
                                <i class="fas fa-calculator"></i>
                            </div>
                            <div class="flex-grow-1">
                                <h5>只为记账服务平台</h5>
                                <p class="text-muted">智能记账助手，自动识别和记录账单信息。</p>

                                <h6>配置参数：</h6>
                                <div class="config-box">
                                    平台名称：记账助手<br>
                                    平台类型：只为记账<br>
                                    服务器地址：https://app.zhiweijz.cn<br>
                                    用户名：your_email@example.com<br>
                                    密码：your_password<br>
                                    自动登录：✓ 勾选<br>
                                    无关消息警告：✓ 勾选
                                </div>

                                <div class="step-list mt-3">
                                    <div class="step-item">
                                        <h6>获取账本</h6>
                                        <p>点击"获取账本"按钮，系统会自动登录并获取可用账本列表。</p>
                                    </div>
                                    <div class="step-item">
                                        <h6>选择账本</h6>
                                        <p>从下拉列表中选择要使用的账本。</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 消息转发规则 -->
                <section id="rules" class="content-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-route me-2"></i>消息转发规则</h2>
                        <p class="text-muted">配置智能消息路由规则，实现精确的消息转发控制。</p>
                    </div>

                    <div class="step-list">
                        <div class="step-item">
                            <h5>添加转发规则</h5>
                            <p>在右侧"消息转发规则配置"面板中，点击"添加规则"按钮。</p>
                        </div>

                        <div class="step-item">
                            <h5>配置规则参数</h5>
                            <div class="config-box">
                                规则名称：AI助手规则<br>
                                微信实例：主微信<br>
                                聊天对象：*（所有聊天对象）<br>
                                服务平台：ChatGPT助手<br>
                                优先级：10<br>
                                仅处理@消息：□ 不勾选<br>
                                启用规则：✓ 勾选
                            </div>
                        </div>

                        <div class="step-item">
                            <h5>聊天对象匹配规则</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>通配符匹配：</h6>
                                    <ul>
                                        <li><code>*</code> - 匹配所有聊天对象</li>
                                        <li><code>工作群*</code> - 匹配以"工作群"开头的群聊</li>
                                        <li><code>*客服</code> - 匹配以"客服"结尾的聊天</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6>精确匹配：</h6>
                                    <ul>
                                        <li><code>技术交流群</code> - 匹配指定群聊</li>
                                        <li><code>张三</code> - 匹配指定好友</li>
                                        <li><code>客服小王</code> - 匹配指定联系人</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="step-item">
                            <h5>优先级设置</h5>
                            <p>数字越小优先级越高，建议按以下方式设置：</p>
                            <div class="config-box">
                                0-10：重要业务规则（如客服群、工作群）<br>
                                11-50：常规聊天规则（如朋友群、同事）<br>
                                51-100：通用回复规则（如所有聊天对象）
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-success-custom">
                        <i class="fas fa-lightbulb me-2"></i>
                        <strong>最佳实践：</strong>为不同类型的聊天对象配置不同的AI平台和规则，实现个性化的自动回复体验。
                    </div>
                </section>

                <!-- Web控制台 -->
                <section id="web-console" class="content-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-globe me-2"></i>Web控制台</h2>
                        <p class="text-muted">通过Web界面远程管理和监控系统状态。</p>
                    </div>

                    <div class="step-list">
                        <div class="step-item">
                            <h5>启动Web服务</h5>
                            <p>在主界面工具栏中，点击"启动服务"按钮。默认端口为8443，可在Web管理选项卡中修改。</p>
                        </div>

                        <div class="step-item">
                            <h5>访问Web界面</h5>
                            <p>点击"打开界面"按钮，系统会自动在浏览器中打开Web管理界面。</p>
                            <div class="config-box">
                                默认访问地址：http://127.0.0.1:8080
                            </div>
                        </div>

                        <div class="step-item">
                            <h5>Web界面功能</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>主要页面：</h6>
                                    <ul>
                                        <li><strong>首页</strong>：系统状态概览</li>
                                        <li><strong>实例管理</strong>：微信实例管理</li>
                                        <li><strong>服务平台</strong>：AI平台配置</li>
                                        <li><strong>转发规则</strong>：规则管理</li>
                                        <li><strong>消息监控</strong>：实时消息流</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6>功能特性：</h6>
                                    <ul>
                                        <li>实时数据更新</li>
                                        <li>响应式设计</li>
                                        <li>移动端适配</li>
                                        <li>操作日志查看</li>
                                        <li>系统状态监控</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 移动端访问 -->
                <section id="mobile-access" class="content-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-mobile-alt me-2"></i>移动端访问</h2>
                        <p class="text-muted">在手机或平板上访问Web控制台，随时随地管理系统。</p>
                    </div>

                    <div class="step-list">
                        <div class="step-item">
                            <h5>获取访问地址</h5>
                            <p>在主界面Web服务控制区域查看IP地址和端口号。</p>
                            <div class="config-box">
                                示例地址：http://192.168.1.100:8080
                            </div>
                        </div>

                        <div class="step-item">
                            <h5>网络要求</h5>
                            <p>确保移动设备与运行软件的电脑在同一局域网内。</p>
                        </div>

                        <div class="step-item">
                            <h5>移动端功能</h5>
                            <ul>
                                <li>查看实例状态</li>
                                <li>监控消息处理</li>
                                <li>查看系统日志</li>
                                <li>基本配置管理</li>
                            </ul>
                        </div>
                    </div>

                    <div class="alert alert-warning-custom">
                        <i class="fas fa-shield-alt me-2"></i>
                        <strong>安全提示：</strong>建议在可信网络环境下使用，避免在公共网络中暴露管理界面。
                    </div>
                </section>

                <!-- 监听对象管理 -->
                <section id="listeners" class="content-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-headphones me-2"></i>监听对象管理</h2>
                        <p class="text-muted">管理固定监听对象，监控特定聊天的消息活动。</p>
                    </div>

                    <div class="step-list">
                        <div class="step-item">
                            <h5>添加监听对象</h5>
                            <p>在"消息监听"选项卡中，点击"添加监听对象"按钮，选择实例和聊天对象。</p>
                        </div>

                        <div class="step-item">
                            <h5>监听状态说明</h5>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="text-center p-3 border rounded">
                                        <i class="fas fa-circle text-success fa-2x mb-2"></i>
                                        <h6>活跃</h6>
                                        <p class="small text-muted">最近有消息活动</p>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="text-center p-3 border rounded">
                                        <i class="fas fa-circle text-warning fa-2x mb-2"></i>
                                        <h6>空闲</h6>
                                        <p class="small text-muted">一段时间无消息</p>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="text-center p-3 border rounded">
                                        <i class="fas fa-circle text-danger fa-2x mb-2"></i>
                                        <h6>超时</h6>
                                        <p class="small text-muted">长时间无消息</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="step-item">
                            <h5>管理操作</h5>
                            <ul>
                                <li><strong>删除监听对象</strong>：点击操作列的"删除"按钮</li>
                                <li><strong>查看详情</strong>：点击对象名称查看详细信息</li>
                                <li><strong>重新初始化</strong>：对于超时的对象，删除后重新添加</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- 高级功能 -->
                <section id="advanced" class="content-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-cogs me-2"></i>高级功能</h2>
                        <p class="text-muted">提升使用体验的高级设置和技巧。</p>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <h5>配置导入导出</h5>
                            <ul>
                                <li><strong>导出配置</strong>：文件 → 导出配置</li>
                                <li><strong>导入配置</strong>：文件 → 导入配置</li>
                                <li>支持完整的系统配置备份</li>
                            </ul>

                            <h5 class="mt-4">日志管理</h5>
                            <ul>
                                <li>实时日志查看</li>
                                <li>不同级别日志区分</li>
                                <li>日志文件自动轮转</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h5>性能优化</h5>
                            <ul>
                                <li>合理设置轮询间隔</li>
                                <li>限制监听对象数量</li>
                                <li>定期清理日志文件</li>
                            </ul>

                            <h5 class="mt-4">安全设置</h5>
                            <ul>
                                <li>API密钥加密存储</li>
                                <li>Web服务访问控制</li>
                                <li>定期更换API密钥</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- 故障排除 -->
                <section id="troubleshooting" class="content-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-tools me-2"></i>故障排除</h2>
                        <p class="text-muted">常见问题的诊断和解决方法。</p>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <h5>连接问题</h5>
                            <div class="step-list">
                                <div class="step-item">
                                    <h6>检查网络连接</h6>
                                    <p>确保能正常访问AI平台API</p>
                                </div>
                                <div class="step-item">
                                    <h6>验证API密钥</h6>
                                    <p>确认密钥格式正确且未过期</p>
                                </div>
                                <div class="step-item">
                                    <h6>检查防火墙</h6>
                                    <p>确保程序能正常访问网络</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h5>消息处理问题</h5>
                            <div class="step-list">
                                <div class="step-item">
                                    <h6>检查规则配置</h6>
                                    <p>确认规则已启用且匹配正确</p>
                                </div>
                                <div class="step-item">
                                    <h6>查看处理日志</h6>
                                    <p>通过日志定位具体问题</p>
                                </div>
                                <div class="step-item">
                                    <h6>测试平台连接</h6>
                                    <p>使用测试连接功能验证平台状态</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 常见问题 -->
                <section id="faq" class="content-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-question-circle me-2"></i>常见问题</h2>
                        <p class="text-muted">用户经常遇到的问题和解决方案。</p>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">
                            <h6><i class="fas fa-chevron-right me-2"></i>Q1: 实例连接失败怎么办？</h6>
                        </div>
                        <div class="faq-answer">
                            <p><strong>A1:</strong> 请按以下步骤排查：</p>
                            <ol>
                                <li>检查API地址格式是否正确（如：http://localhost:5000）</li>
                                <li>确认微信API服务（如wxauto_http_api.exe）是否正常运行</li>
                                <li>检查网络连接是否正常</li>
                                <li>验证API密钥是否正确（如果需要）</li>
                                <li>查看日志获取详细错误信息</li>
                            </ol>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">
                            <h6><i class="fas fa-chevron-right me-2"></i>Q2: 服务平台测试连接失败？</h6>
                        </div>
                        <div class="faq-answer">
                            <p><strong>A2:</strong> 请检查以下项目：</p>
                            <ol>
                                <li><strong>API密钥</strong>：确认密钥格式正确且未过期</li>
                                <li><strong>API地址</strong>：确认地址可访问且格式正确</li>
                                <li><strong>网络连接</strong>：检查是否能正常访问外网</li>
                                <li><strong>平台服务</strong>：确认第三方平台服务正常</li>
                                <li><strong>账户状态</strong>：检查API账户余额和权限</li>
                            </ol>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">
                            <h6><i class="fas fa-chevron-right me-2"></i>Q3: 消息转发不生效？</h6>
                        </div>
                        <div class="faq-answer">
                            <p><strong>A3:</strong> 请按以下步骤检查：</p>
                            <ol>
                                <li><strong>规则状态</strong>：确认转发规则已启用</li>
                                <li><strong>聊天对象匹配</strong>：检查聊天对象名称是否完全匹配</li>
                                <li><strong>服务平台状态</strong>：确认关联的服务平台工作正常</li>
                                <li><strong>规则优先级</strong>：检查是否有更高优先级的规则覆盖</li>
                                <li><strong>@消息设置</strong>：确认@消息处理设置符合预期</li>
                                <li><strong>实例状态</strong>：确认微信实例连接正常</li>
                            </ol>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">
                            <h6><i class="fas fa-chevron-right me-2"></i>Q4: Web控制台无法访问？</h6>
                        </div>
                        <div class="faq-answer">
                            <p><strong>A4:</strong> 请检查以下设置：</p>
                            <ol>
                                <li><strong>服务状态</strong>：确认Web服务已启动（工具栏显示"停止服务"）</li>
                                <li><strong>端口占用</strong>：检查8443端口是否被其他程序占用</li>
                                <li><strong>防火墙设置</strong>：确认防火墙允许程序通过</li>
                                <li><strong>IP地址</strong>：确认使用正确的IP地址访问</li>
                                <li><strong>浏览器兼容性</strong>：尝试使用不同浏览器访问</li>
                            </ol>
                        </div>
                    </div>

                    <div class="faq-item">
                        <div class="faq-question" onclick="toggleFaq(this)">
                            <h6><i class="fas fa-chevron-right me-2"></i>Q5: 如何提高回复质量？</h6>
                        </div>
                        <div class="faq-answer">
                            <p><strong>A5:</strong> 以下建议可以提高AI回复质量：</p>
                            <ol>
                                <li><strong>优化系统提示词</strong>：详细描述AI的角色和回复风格</li>
                                <li><strong>选择合适的模型</strong>：GPT-4质量更好，GPT-3.5性价比高</li>
                                <li><strong>调整Temperature</strong>：降低值获得更稳定的回复</li>
                                <li><strong>设置合理的Token限制</strong>：避免回复过长或过短</li>
                                <li><strong>使用多平台策略</strong>：不同场景使用不同的AI平台</li>
                            </ol>
                        </div>
                    </div>
                </section>

                <!-- 技术支持 -->
                <section class="content-section">
                    <div class="section-header">
                        <h2 class="section-title"><i class="fas fa-life-ring me-2"></i>技术支持</h2>
                        <p class="text-muted">获取帮助和支持的方式。</p>
                    </div>

                    <div class="row">
                        <div class="col-md-4 text-center mb-4">
                            <i class="fas fa-book fa-3x text-primary mb-3"></i>
                            <h5>文档资源</h5>
                            <p class="text-muted">查看完整的用户手册和API文档</p>
                            <a href="quick-start-guide.html" class="btn btn-outline-primary">快速入门</a>
                        </div>
                        <div class="col-md-4 text-center mb-4">
                            <i class="fas fa-users fa-3x text-success mb-3"></i>
                            <h5>社区支持</h5>
                            <p class="text-muted">加入用户交流群，与其他用户交流经验</p>
                            <button class="btn btn-outline-success" onclick="alert('QQ群：955097147')">加入群聊</button>
                        </div>
                        <div class="col-md-4 text-center mb-4">
                            <i class="fas fa-life-ring fa-3x text-primary mb-3"></i>
                            <h5>技术支持</h5>
                            <p class="text-muted">联系技术支持团队获取专业帮助</p>
                            <a href="https://github.com/zj591227045/WXAUTO-MGT/issues" target="_blank" class="btn btn-outline-primary">获取帮助</a>
                        </div>
                    </div>

                    <div class="alert alert-info-custom">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>提交问题时请提供：</strong>软件版本、操作系统信息、详细的错误描述和相关日志信息，以便我们更好地帮助您解决问题。
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- 页脚 -->
    <footer class="bg-dark text-white py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-6">
                    <h5><i class="fas fa-robot me-2"></i>WXAUTO-MGT</h5>
                    <p class="text-muted">智能微信消息管理工具，让AI为您自动处理消息回复。</p>
                    <p class="text-muted">版本：v2.0.0 | 更新时间：2025年1月</p>
                </div>
                <div class="col-lg-6 text-lg-end">
                    <h6>快速链接</h6>
                    <ul class="list-unstyled">
                        <li><a href="index.html" class="text-muted text-decoration-none">首页</a></li>
                        <li><a href="quick-start-guide.html" class="text-muted text-decoration-none">快速入门</a></li>
                        <li><a href="how-to-insert-screenshots.md" class="text-muted text-decoration-none">截图指导</a></li>
                    </ul>
                </div>
            </div>
            <hr class="my-3">
            <div class="text-center text-muted">
                <p>&copy; 2025 WXAUTO-MGT. 保留所有权利。</p>
            </div>
        </div>
    </footer>

    <!-- 返回顶部按钮 -->
    <button id="backToTop" class="btn btn-primary position-fixed" style="bottom: 20px; right: 20px; display: none; z-index: 1000; border-radius: 50%; width: 50px; height: 50px;">
        <i class="fas fa-arrow-up"></i>
    </button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 侧边栏导航高亮
        function updateActiveNav() {
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.sidebar a[data-section]');

            let currentSection = '';
            sections.forEach(section => {
                const rect = section.getBoundingClientRect();
                if (rect.top <= 100 && rect.bottom > 100) {
                    currentSection = section.id;
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-section') === currentSection) {
                    link.classList.add('active');
                }
            });
        }

        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // FAQ折叠功能
        function toggleFaq(element) {
            const answer = element.nextElementSibling;
            const icon = element.querySelector('i');

            if (answer.classList.contains('show')) {
                answer.classList.remove('show');
                icon.classList.remove('fa-chevron-down');
                icon.classList.add('fa-chevron-right');
            } else {
                // 关闭其他FAQ
                document.querySelectorAll('.faq-answer.show').forEach(item => {
                    item.classList.remove('show');
                });
                document.querySelectorAll('.faq-question i').forEach(item => {
                    item.classList.remove('fa-chevron-down');
                    item.classList.add('fa-chevron-right');
                });

                // 打开当前FAQ
                answer.classList.add('show');
                icon.classList.remove('fa-chevron-right');
                icon.classList.add('fa-chevron-down');
            }
        }

        // 返回顶部按钮
        const backToTopBtn = document.getElementById('backToTop');

        function toggleBackToTop() {
            if (window.scrollY > 300) {
                backToTopBtn.style.display = 'block';
            } else {
                backToTopBtn.style.display = 'none';
            }
        }

        backToTopBtn.addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // 滚动监听
        window.addEventListener('scroll', function() {
            updateActiveNav();
            toggleBackToTop();

            // 导航栏滚动效果
            const navbar = document.querySelector('.navbar');
            if (window.scrollY > 50) {
                navbar.style.backgroundColor = 'rgba(37, 99, 235, 0.95)';
            } else {
                navbar.style.backgroundColor = '';
            }
        });

        // 页面加载完成后初始化
        window.addEventListener('load', function() {
            updateActiveNav();

            // 为平台卡片添加点击效果
            document.querySelectorAll('.platform-card').forEach(card => {
                card.addEventListener('click', function() {
                    this.style.transform = 'scale(1.02)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 200);
                });
            });
        });

        // 搜索功能（可选）
        function searchContent(query) {
            const sections = document.querySelectorAll('.content-section');
            const searchQuery = query.toLowerCase();

            sections.forEach(section => {
                const content = section.textContent.toLowerCase();
                if (content.includes(searchQuery)) {
                    section.style.display = 'block';
                } else {
                    section.style.display = 'none';
                }
            });
        }

        // 键盘快捷键
        document.addEventListener('keydown', function(e) {
            // Ctrl+F 搜索
            if (e.ctrlKey && e.key === 'f') {
                e.preventDefault();
                const searchTerm = prompt('搜索内容：');
                if (searchTerm) {
                    searchContent(searchTerm);
                }
            }

            // ESC 清除搜索
            if (e.key === 'Escape') {
                document.querySelectorAll('.content-section').forEach(section => {
                    section.style.display = 'block';
                });
            }
        });
    </script>
</body>
</html>
